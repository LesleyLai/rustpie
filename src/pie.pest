COMMENT = _{ "#|" ~ (!"|#" ~ ANY)* ~ "|#" | ";;" ~ ANY* ~ NEWLINE }
WHITESPACE = _{ (" " | NEWLINE ) }

ident = @{ nondigit ~ (nondigit | ASCII_DIGIT)* }
    nondigit = { LETTER | MATH_SYMBOL | DASH_PUNCTUATION }

atom = @{ "'" ~ ident }

cons = { "(" ~ "cons" ~ expr ~ expr ~ ")" }

pair = { "(" ~ "Pair" ~ expr ~ expr ~ ")" }

sexpr = { "(" ~ expr ~ expr* ~ ")" }

car = { "(" ~ "car" ~ expr ~ ")" }

cdr = { "(" ~ "cdr" ~ expr ~ ")" }

nat_literal = { ASCII_DIGIT+ }

add1 = { "(" ~ "add1" ~ expr ~ ")" }

expr = { cons | pair | atom | car | cdr | ident | nat_literal | add1 | sexpr }

pie = { SOI ~ expr* ~ EOI }
